{
    "entityprotos" : {
        "peasant" : {
            "name" : "Peasant",
            "rank" : 30,
            "components" : ["moving", "appearance","behaviour"],
            "appearance" : {
                "sprite" : "res/unit-pesant.png",
                "portrait" : "res/unit-pesant.png"
            },
            "locator" : { "r" : 32 },
            "behaviour" : { "type" : "unit" }
        },
        "archer" : {
            "name" : "Archer",
            "rank" : 20,
            "components" : ["moving", "appearance", "behaviour", "variables", "abilities", "maprevealer"],
            "appearance" : {
                "sprite" : "res/unit-archer.png",
                "portrait" : "res/unit-archer.png"
            },
            "behaviour" : { "type" : "unit" },
            "locator" : { "r" : 32 },
            "variables" : {
                "hp" : { "max" : "maxhp", "regen" : "hpregen" },
                "mana" : { "max" : "maxmp", "regen" : "mpregen", "initial" : "70" }
            },
            "stats" : {
                "maxhp" : 250,
                "hpregen" : 20,
                "maxmp" : 200,
                "mpregen" : 20,
                "sight" : 256
            },
            "abilities" : [ "boost", "heal" ]
        },
        "townhall" : {
            "name" : "Town Hall",
            "rank" : 100,
            "components" : ["town", "appearance", "behaviour", "maprevealer",
                "footprint", "abilities", "harveststore", "queue"],
            "appearance" : {
                "sprite" : "res/bldg-townhall.png",
                "portrait" : "res/bldg-townhall.png"
            },
            "behaviour" : { "type" : "building" },
            "locator" : { "r" : 128 },
            "stats" : {
                "sight" : 1024
            },
            "abilities" : [ "train_archer" ],
            "town" : { "r" : 1024 }
        },
        "goldmine" : {
            "name" : "Gold Mine",
            "rank" : 200,
            "components" : ["appearance", "footprint", "resource"],
            "appearance" : {
                "sprite" : "res/bldg-goldmine.png",
                "portrait" : "res/bldg-goldmine.png",
                "visibility" : "visited"
            },
            "locator" : { "r" : 128 },
            "resource" : {
                "kind": "resource",
                "deplete" : [
                    "function(me)",
                    "    print('gold mine depleted')",
                    "end"
                ]
            }
        },
        "tree" : {
            "name" : "Tree",
            "rank" : 250,
            "components" : ["appearance", "footprint", "resource"],
            "appearance" : {
                "sprite" : "res/unit-tree.png",
                "portrait" : "res/unit-tree.png",
                "visibility" : "visited"
            },
            "locator" : { "r" : 64 },
            "resource" : {
                "kind": "resource",
                "quantity" : 50,
                "deplete" : [
                    "function(me)",
                    "    print('tree depleted')",
                    "    --destroy(me)",
                    "end"
                ]
            }
        }
    },

    "entities" : {
        "1" : {
            "team" : 0,
            "proto" : "peasant",
            "locator" : {
                "x" : 700, "y" : 700, "placed" : true
            }
        },
        "2" : {
            "team" : 0,
            "proto" : "archer",
            "locator" : {
                "x" : 800, "y" : 800, "placed" : true
            }
        },
        "3" : {
            "team" : 0,
            "proto" : "archer",
            "locator" : {
                "x" : 250, "y" : 250, "placed" : true
            }
        },
        "4" : {
            "team" : 0,
            "proto" : "townhall",
            "locator" : {
                "x" : 500, "y" : 500, "placed" : true
            },
            "town" : 0
        },
        "5" : {
            "team" : 1,
            "proto" : "goldmine",
            "locator" : {
                "x" : 2000, "y" : 500, "placed" : true
            },
            "resource" : {
                "quantity" : 100
            }
        },
        "6": { "team": 1, "proto": "tree", "locator": {"x": 100, "y": 200}},
        "7": { "team": 1, "proto": "tree", "locator": {"x": 164, "y": 200}},
        "8": { "team": 1, "proto": "tree", "locator": {"x": 228, "y": 200}},
        "9": { "team": 1, "proto": "tree", "locator": {"x": 292, "y": 200}}
    },

    "content" : {
        "abilities" : {
            "boost" : {
                "type" : "instant",
                "name" : "HP Boost",
                "description" : "Raises MaxHP by 10% for 30s",
                "effect" : [
                    "function(me, target)",
                    "    print('Inside Lua boost' .. me)",
                    "    print(target)",
                    "    place_entity(me, 600, 600)",
                    "end"
                ],
                "group" : true,
                "cooldown" : 60,
                "cost" : { "mana" : 100 },
                "image" : "res/unit-pesant.png"
            },
            "heal" : {
                "type" : "targeted",
                "name" : "Heal",
                "description" : "Restores 100 HP to target unit",
                "effect" : [
                    "function(me, target)",
                    "    print('Inside Lua heal' .. me)",
                    "    print(target)",
                    "    write_variable(target, 'hp', 'add', -100)",
                    "end"
                ],
                "cooldown" : 60,
                "cost" : { "mana" : 100 },
                "image" : "res/unit-pesant.png"
            },
            "train_archer" : {
                "type" : "activity",
                "name" : "Train Archer",
                "description" : "Trains an Archer",
                "effect" : [
                    "function(me)",
                    "    print('Inside train archer')",
                    "    ent = create_entity(0, 'archer')",
                    "    place_entity_near(ent, me)",
                    "end"
                ],
                "wait": 120,
                "queue" : true,
                "cost" : { "energy" : 100, "resource" : 100 },
                "image" : "res/unit-pesant.png"
            },
            "build_townhall" : {
                "type" : "build",
                "name" : "Build Townhall",
                "description" : "Builds a Townhall",
                "effect" : { "file": "abilities.lua", "function": "build_townhall" },
                "cooldown" : 60,
                "cost" : { },
                "image" : "res/bldg-townhall.png",
                "ghost" : "res/bldg-townhall.png"
            }
        }
    },

    "teams" : {
        "0" : {
            "entityprotos" : {
                "peasant" : {
                    "name" : "Peasant Upgraded",
                    "rank" : 30,
                    "components" : ["moving", "appearance", "behaviour", "maprevealer","abilities", "harvester"],
                    "appearance" : {
                        "sprite" : "res/unit-pesant.png",
                        "portrait" : "res/unit-pesant.png"
                    },
                    "abilities" : [ "build_townhall" ],
                    "behaviour" : { "type" : "unit" },
                    "locator" : { "r" : 32 },
                    "stats" : {
                        "sight" : 256,
                        "speed" : 32
                    },
                    "harvester" : { "rate": 100, "capacity": 10 }
                }
            },    
            "towns" : {
                "0" : {
                    "race" : "human",
                    "resources" : { "resource" : 1000, "energy" : 1000 }
                }
            }
        },
        "1" : {
            "entityprotos" : {}
        }
    },

    "players" : [
        {
            "teams" : [0],
            "type" : "human"
        },
        {
            "teams" : [1],
            "type" : "passive"
        }
    ],

    "races" : {
        "human" : {
            "resource" : "Lumber",
            "resource_icon" : "res/lumber.png",
            "energy" : "Gold",
            "energy_icon" : "res/sunlight.png"
        },
        "elves": {
            "resource" : "Lumber",
            "resource_icon" : "res/lumber.png",
            "energy" : "Sunlight",
            "energy_icon" : "res/sunlight.png"
        }

    },

    "misc" : {
        "camera.initial.position" : {
            "0" : { "x" : 0, "y" : 0 },
            "1" : { "x" : 0, "y" : 0 }
        },
        "entities.nexteid" : 100
    },

    "tileset" : {
        "texture" : "terrain_grass.png",
        "fogofwar" : "fogofwar.png"
    },        

    "map" : {
        "loaded" : ["0/0"],
        "sectors" : {
            "0/0" : {
                "tiles" : "tiles.hex",
                "entities" : [1, 2, 3, 4, 5, 6, 7, 8, 9]
            },
            "0/1" : {
                "tiles" : "tiles.hex"
            },
            "1/1" : {
                "tiles" : "tiles.hex"
            },
            "1/0" : {
                "tiles" : "tiles.hex"
            }
        }
    }
}